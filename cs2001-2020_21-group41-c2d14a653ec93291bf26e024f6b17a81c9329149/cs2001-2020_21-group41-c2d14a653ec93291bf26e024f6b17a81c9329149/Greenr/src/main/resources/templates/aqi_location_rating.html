<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AQI Location Rating</title>
    <link rel="stylesheet" type="text/css" href="../static/css/aqi.css">
    <script  type="text/javascript"  charset="utf-8">  
      (function(w,d,t,f){   
          w[f]=w[f]||function(c,k,n){s=w[f],
          k=s['k']=(s['k']||(k?('&k='+k):''));
          s['c']=c=(c instanceof Array)?c:[c];s['n']=n=n||0;
          L=d.createElement(t),
          e=d.getElementsByTagName(t)[0];  
          L.async=1;
          L.src='//feed.aqicn.org/feed/'+(c[n].city)+'/'+(c[n].lang||'')+'/feed.v1.js?n='+n+k;  
          e.parentNode.insertBefore(L,e);  
      };  
      })  (window,document,'script','_aqiFeed');
  
      function getAQI(){
          const apiKey = '9ca3e675f648207f79b79892efab5b021f38bf6b'
          let city = document.getElementById("city").value
          fetch('https://api.waqi.info/feed/' + city + '/?token=' + apiKey)
          .then(response => response.json())
          .then(data => {
              let aqiValue = data.data.aqi  
          _aqiFeed({  
              display:"%cityname  AQI  is  %aqi (last updated on %date)<br> Your AQI rating is:<span style='%style;'>%impact</span><br><span style='font-size:12px'> Air Quality Information for %cityname is provided by %attribution</span>",
              container:"city-aqi-container",  
              city:city,
              });
          });
      }
      </script>
      </head>

  <body>
  <h1><strong>Get the AQI rating for your area</strong></h1>
  <form onsubmit="getAQI(); return false" id = "location_form">
      <label for="area"> Enter your location:</label>
      <input type="text" name="area" id="city" placeholder="Type your city">
      <button type="submit" form="location_form" value="Submit">Get AQI rating</button>
  </form>
  <p id ="city-aqi-container"><br><br><br></p>
  <figure>
      <img src= "../static/img/aqi_table.png" alt="aqi rating table" width="950">
      <figcaption style="font-size: 13px;"><strong>Purpose:</strong> The AQI above will need to be compared to this table in order to gauge how safe your city's air is and whether there should be any cause for concern</figcaption>
  </figure>
  </body>
</html>